import{a as M}from"./index.d7128fdc.js";import{aq as T,av as Ie,d as me,e as F,ao as ue,h as ne,bH as ve,bI as _e,bJ as Le,k as pe,l as ge,bm as ze,r as k,bK as Ee,af as Se,o as y,w as ce,p as we,L as ye,x as h,y as de,Q as m,z as E,G as b,A as p,t as e,B as fe,C as Ce,E as S,a6 as Ne,F as x,M as ae,_ as xe,$ as Oe,bL as Te,ac as Re,D as $e,bM as Ae,bN as Be,N as Me,P as Ve,Y as Ye,H as te,U as Pe,bn as De,bO as He,a8 as be,j as Xe,J as Fe,aN as je,a7 as Ke,I as We,bP as qe}from"./index.6fcafbfe.js";import{g as Ge,E as O,_ as he}from"./base.57a2ecae.js";import{m as ke,u as Je}from"./index.df152c9c.js";import{d as Ue,E as B}from"./aria.f1210f48.js";const Ze=(o,c)=>{if(!T||!o||!c)return!1;const n=o.getBoundingClientRect();let d;return c instanceof Element?d=c.getBoundingClientRect():d={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},n.top<d.bottom&&n.bottom>d.top&&n.right>d.left&&n.left<d.right};var Qe="Expected a function";function ie(o,c,n){var d=!0,l=!0;if(typeof o!="function")throw new TypeError(Qe);return Ie(n)&&(d="leading"in n?!!n.leading:d,l="trailing"in n?!!n.trailing:l),Ue(o,c,{leading:d,maxWait:c,trailing:l})}const et=(o,c)=>{if(!T)return!1;const n={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(c)],d=Ge(o,n);return["scroll","auto","overlay"].some(l=>d.includes(l))},tt=(o,c)=>{if(!T)return;let n=o;for(;n;){if([window,document,document.documentElement].includes(n))return window;if(et(n,c))return n;n=n.parentNode}return n},at=me({urlList:{type:F(Array),default:()=>ke([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:F(String)}}),nt={close:()=>!0,switch:o=>ue(o),rotate:o=>ue(o)},st=["src","crossorigin"],ot=ne({name:"ElImageViewer"}),lt=ne({...ot,props:at,emits:nt,setup(o,{expose:c,emit:n}){var d;const l=o,w={CONTAIN:{name:"contain",icon:ve(_e)},ORIGINAL:{name:"original",icon:ve(Le)}},{t:se}=pe(),u=ge("image-viewer"),{nextZIndex:V}=ze(),C=k(),N=k([]),R=Ee(),I=k(!0),f=k(l.initialIndex),$=Se(w.CONTAIN),r=k({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),Y=k((d=l.zIndex)!=null?d:V()),oe=y(()=>{const{urlList:a}=l;return a.length<=1}),j=y(()=>f.value===0),K=y(()=>f.value===l.urlList.length-1),P=y(()=>l.urlList[f.value]),le=y(()=>[u.e("btn"),u.e("prev"),u.is("disabled",!l.infinite&&j.value)]),W=y(()=>[u.e("btn"),u.e("next"),u.is("disabled",!l.infinite&&K.value)]),D=y(()=>{const{scale:a,deg:s,offsetX:i,offsetY:_,enableTransition:z}=r.value;let g=i/a,L=_/a;switch(s%360){case 90:case-270:[g,L]=[L,-g];break;case 180:case-180:[g,L]=[-g,-L];break;case 270:case-90:[g,L]=[-L,g];break}const A={transform:`scale(${a}) rotate(${s}deg) translate(${g}px, ${L}px)`,transition:z?"transform .3s":""};return $.value.name===w.CONTAIN.name&&(A.maxWidth=A.maxHeight="100%"),A});function H(){q(),n("close")}function re(){const a=ie(i=>{switch(i.code){case B.esc:l.closeOnPressEscape&&H();break;case B.space:Q();break;case B.left:ee();break;case B.up:v("zoomIn");break;case B.right:t();break;case B.down:v("zoomOut");break}}),s=ie(i=>{const _=i.deltaY||i.deltaX;v(_<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})});R.run(()=>{M(document,"keydown",a),M(document,"wheel",s)})}function q(){R.stop()}function G(){I.value=!1}function J(a){I.value=!1,a.target.alt=se("el.image.error")}function U(a){if(I.value||a.button!==0||!C.value)return;r.value.enableTransition=!1;const{offsetX:s,offsetY:i}=r.value,_=a.pageX,z=a.pageY,g=ie(A=>{r.value={...r.value,offsetX:s+A.pageX-_,offsetY:i+A.pageY-z}}),L=M(document,"mousemove",g);M(document,"mouseup",()=>{L()}),a.preventDefault()}function Z(){r.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function Q(){if(I.value)return;const a=He(w),s=Object.values(w),i=$.value.name,z=(s.findIndex(g=>g.name===i)+1)%a.length;$.value=w[a[z]],Z()}function X(a){const s=l.urlList.length;f.value=(a+s)%s}function ee(){j.value&&!l.infinite||X(f.value-1)}function t(){K.value&&!l.infinite||X(f.value+1)}function v(a,s={}){if(I.value)return;const{minScale:i,maxScale:_}=l,{zoomRate:z,rotateDeg:g,enableTransition:L}={zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0,...s};switch(a){case"zoomOut":r.value.scale>i&&(r.value.scale=Number.parseFloat((r.value.scale/z).toFixed(3)));break;case"zoomIn":r.value.scale<_&&(r.value.scale=Number.parseFloat((r.value.scale*z).toFixed(3)));break;case"clockwise":r.value.deg+=g,n("rotate",r.value.deg);break;case"anticlockwise":r.value.deg-=g,n("rotate",r.value.deg);break}r.value.enableTransition=L}return ce(P,()=>{we(()=>{const a=N.value[0];a!=null&&a.complete||(I.value=!0)})}),ce(f,a=>{Z(),n("switch",a)}),ye(()=>{var a,s;re(),(s=(a=C.value)==null?void 0:a.focus)==null||s.call(a)}),c({setActiveItem:X}),(a,s)=>(h(),de(De,{to:"body",disabled:!a.teleported},[m(Pe,{name:"viewer-fade",appear:""},{default:E(()=>[b("div",{ref_key:"wrapper",ref:C,tabindex:-1,class:p(e(u).e("wrapper")),style:fe({zIndex:Y.value})},[b("div",{class:p(e(u).e("mask")),onClick:s[0]||(s[0]=Ce(i=>a.hideOnClickModal&&H(),["self"]))},null,2),S(" CLOSE "),b("span",{class:p([e(u).e("btn"),e(u).e("close")]),onClick:H},[m(e(O),null,{default:E(()=>[m(e(Ne))]),_:1})],2),S(" ARROW "),e(oe)?S("v-if",!0):(h(),x(ae,{key:0},[b("span",{class:p(e(le)),onClick:ee},[m(e(O),null,{default:E(()=>[m(e(xe))]),_:1})],2),b("span",{class:p(e(W)),onClick:t},[m(e(O),null,{default:E(()=>[m(e(Oe))]),_:1})],2)],64)),S(" ACTIONS "),b("div",{class:p([e(u).e("btn"),e(u).e("actions")])},[b("div",{class:p(e(u).e("actions__inner"))},[m(e(O),{onClick:s[1]||(s[1]=i=>v("zoomOut"))},{default:E(()=>[m(e(Te))]),_:1}),m(e(O),{onClick:s[2]||(s[2]=i=>v("zoomIn"))},{default:E(()=>[m(e(Re))]),_:1}),b("i",{class:p(e(u).e("actions__divider"))},null,2),m(e(O),{onClick:Q},{default:E(()=>[(h(),de($e(e($).icon)))]),_:1}),b("i",{class:p(e(u).e("actions__divider"))},null,2),m(e(O),{onClick:s[3]||(s[3]=i=>v("anticlockwise"))},{default:E(()=>[m(e(Ae))]),_:1}),m(e(O),{onClick:s[4]||(s[4]=i=>v("clockwise"))},{default:E(()=>[m(e(Be))]),_:1})],2)],2),S(" CANVAS "),b("div",{class:p(e(u).e("canvas"))},[(h(!0),x(ae,null,Me(a.urlList,(i,_)=>Ve((h(),x("img",{ref_for:!0,ref:z=>N.value[_]=z,key:i,src:i,style:fe(e(D)),class:p(e(u).e("img")),crossorigin:a.crossorigin,onLoad:G,onError:J,onMousedown:U},null,46,st)),[[Ye,_===f.value]])),128))],2),te(a.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var rt=he(lt,[["__file","image-viewer.vue"]]);const it=be(rt),ut=me({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:F([String,Object])},previewSrcList:{type:F(Array),default:()=>ke([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:F(String)}}),ct={load:o=>o instanceof Event,error:o=>o instanceof Event,switch:o=>ue(o),close:()=>!0,show:()=>!0},dt=["src","loading","crossorigin"],ft={key:0},vt=ne({name:"ElImage",inheritAttrs:!1}),mt=ne({...vt,props:ut,emits:ct,setup(o,{emit:c}){const n=o;let d="";const{t:l}=pe(),w=ge("image"),se=Xe(),u=Je(),V=k(),C=k(!1),N=k(!0),R=k(!1),I=k(),f=k(),$=T&&"loading"in HTMLImageElement.prototype;let r,Y;const oe=y(()=>[w.e("inner"),P.value&&w.e("preview"),N.value&&w.is("loading")]),j=y(()=>se.style),K=y(()=>{const{fit:t}=n;return T&&t?{objectFit:t}:{}}),P=y(()=>{const{previewSrcList:t}=n;return Array.isArray(t)&&t.length>0}),le=y(()=>{const{previewSrcList:t,initialIndex:v}=n;let a=v;return v>t.length-1&&(a=0),a}),W=y(()=>n.loading==="eager"?!1:!$&&n.loading==="lazy"||n.lazy),D=()=>{!T||(N.value=!0,C.value=!1,V.value=n.src)};function H(t){N.value=!1,C.value=!1,c("load",t)}function re(t){N.value=!1,C.value=!0,c("error",t)}function q(){Ze(I.value,f.value)&&(D(),U())}const G=qe(q,200,!0);async function J(){var t;if(!T)return;await we();const{scrollContainer:v}=n;je(v)?f.value=v:Ke(v)&&v!==""?f.value=(t=document.querySelector(v))!=null?t:void 0:I.value&&(f.value=tt(I.value)),f.value&&(r=M(f,"scroll",G),setTimeout(()=>q(),100))}function U(){!T||!f.value||!G||(r==null||r(),f.value=void 0)}function Z(t){if(!!t.ctrlKey){if(t.deltaY<0)return t.preventDefault(),!1;if(t.deltaY>0)return t.preventDefault(),!1}}function Q(){!P.value||(Y=M("wheel",Z,{passive:!1}),d=document.body.style.overflow,document.body.style.overflow="hidden",R.value=!0,c("show"))}function X(){Y==null||Y(),document.body.style.overflow=d,R.value=!1,c("close")}function ee(t){c("switch",t)}return ce(()=>n.src,()=>{W.value?(N.value=!0,C.value=!1,U(),J()):D()}),ye(()=>{W.value?J():D()}),(t,v)=>(h(),x("div",{ref_key:"container",ref:I,class:p([e(w).b(),t.$attrs.class]),style:fe(e(j))},[C.value?te(t.$slots,"error",{key:0},()=>[b("div",{class:p(e(w).e("error"))},We(e(l)("el.image.error")),3)]):(h(),x(ae,{key:1},[V.value!==void 0?(h(),x("img",Fe({key:0},e(u),{src:V.value,loading:t.loading,style:e(K),class:e(oe),crossorigin:t.crossorigin,onClick:Q,onLoad:H,onError:re}),null,16,dt)):S("v-if",!0),N.value?(h(),x("div",{key:1,class:p(e(w).e("wrapper"))},[te(t.$slots,"placeholder",{},()=>[b("div",{class:p(e(w).e("placeholder"))},null,2)])],2)):S("v-if",!0)],64)),e(P)?(h(),x(ae,{key:2},[R.value?(h(),de(e(it),{key:0,"z-index":t.zIndex,"initial-index":e(le),infinite:t.infinite,"zoom-rate":t.zoomRate,"min-scale":t.minScale,"max-scale":t.maxScale,"url-list":t.previewSrcList,"hide-on-click-modal":t.hideOnClickModal,teleported:t.previewTeleported,"close-on-press-escape":t.closeOnPressEscape,onClose:X,onSwitch:ee},{default:E(()=>[t.$slots.viewer?(h(),x("div",ft,[te(t.$slots,"viewer")])):S("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):S("v-if",!0)],64)):S("v-if",!0)],6))}});var pt=he(mt,[["__file","image.vue"]]);const kt=be(pt);export{kt as E};
